<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="Godot is getting iOS support for C# games. There is also a new system for using Godot signals as C# events.">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org/article/csharp-ios-signals-events/">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="C# progress report: iOS and signals as events">
	<meta property="og:description" content="Godot is getting iOS support for C# games. There is also a new system for using Godot signals as C# events.">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/5e8/92c/7b8/5e892c7b82886061410800.png">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>C# progress report: iOS and signals as events</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css?109">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/icons/hamburger.svg" width="24" height="24" alt="Main menu">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/features">Features</a></li>
				<div class="only-on-mobile" style="width: 100%">
					<li><a href="/showcase">Showcase</a></li>
				</div>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Community</a></li>
				<li><a href="/contact">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Learn</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="https://fund.godotengine.org">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.article-info {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.article-metadata {
		display: flex;
		gap: 24px;
		align-items: center;
		font-family: var(--header-font-family);
		margin-bottom: 12px;
	}

	@media (max-width: 900px) {
		.article-metadata {
			flex-direction: column;
			align-items: flex-start;
			gap: 16px;
		}
	}

	.article-author {
		color: var(--base-color-text-subtitle-date);
		font-weight: 700;
		font-size: 18px;
		flex-grow: 1;
		display: flex;
		gap: 12px;
		align-items: center;
	}

	.article-author .avatar {
		border-radius: 100%;
		margin: 0;
	}

	.article-author .by {
		color: var(--base-color-text-subtitle);
	}

	.article-metadata .date {
		color: var(--base-color-text-subtitle-date);
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="padded">
		<div class="content article-container">
			<figure class="article-cover">
				

				<img src="/storage/app/uploads/public/5e8/92c/7b8/5e892c7b82886061410800.png" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto" />
			</figure>

			<div class="article-info">
				<h1>
					C# progress report: iOS and signals as events
				</h1>
				<div class="article-metadata">
					<div class="article-author">
						<span>By: </span>
						
						
							<img class="avatar" width="25" height="25" src="/assets/images/authors/ignacio.png" alt="Ignacio Roldán Etcheverry" loading="lazy">
						
						<span class="by">Ignacio Roldán Etcheverry</span>
					</div>
					<span class="date">  6 April 2020</span>
				</div>

				<div class="tags">
					
					<a href="/blog/progress-report">
						<div class="tag active">Progress Report</div>
					</a>
					
				</div>
			</div>

			



	<div class="card card-warning">
		<p>
		
			This article is from <strong>April 2020</strong>, some of its contents might be outdated and no longer accurate.<br>
			You can find up-to-date information about the engine in the <a href="https://docs.godotengine.org/en/stable/">official documentation</a>.
		
		</p>
	</div>





			<div class="article-body">
				<p>Initially and for quite some time C# was only supported in Godot on desktop platforms. In the last year we made good progress extending support to Android and WebAssembly, and now it’s time to add iOS to that list as well.</p>

<p>In this progress report I’m also introducing a new way of working with Godot signals in C#.</p>

<p>This work is kindly sponsored by Microsoft.</p>

<h1 id="ios-support">iOS support</h1>

<p><img src="/storage/app/media/mono/csharp_dodgethecreeps_ios_sim.png" alt="DodgeTheCreepsCS on the iOS Simulator" />
<em>The <a href="https://github.com/godotengine/godot-demo-projects/tree/master/mono/dodge_the_creeps">Dodge The Creeps C#</a> demo running on the iOS Simulator</em></p>

<p>Godot 4.0 will be getting C# support for iOS. We also plan to include it in a 3.2.x release, which could be 3.2.2 if everything goes well.</p>

<p>Similarly to WebAssembly, the Mono JIT compiler is not available on iOS devices. Instead, Godot will perform Ahead-of-Time (AOT) compilation when exporting a game and the resulting libraries will be added to the generated Xcode project.</p>

<p>Other than the additional time that is spent doing AOT compilation of assemblies, the export process should be the same as it is with games that don’t use C#.</p>

<p>For those interested in building Godot from source, the code is available in the <a href="https://github.com/godotengine/godot/tree/3.2-mono-ios">3.2-mono-ios</a> branch (soon to be merged in the <code class="language-plaintext highlighter-rouge">3.2</code> branch). Currently the <code class="language-plaintext highlighter-rouge">master</code> branch doesn’t support a lot of platforms (including iOS) due to the ongoing work with the renderer.
The <a href="https://docs.godotengine.org/en/latest/development/compiling/compiling_with_mono.html">Compiling with Mono</a> page includes information about building the Mono runtime, the Base Class Library and the AOT cross-compiler.</p>

<h1 id="signals-as-events">Signals as events</h1>

<p><a href="https://docs.godotengine.org/en/latest/getting_started/step_by_step/signals.html">Signals</a> are the Godot version of the <em>observer</em> pattern. Engine classes use signals to notify listeners when an event occurs. User scripts can also create their own signals.</p>

<p>This is what a signal declaration looks like in GDScript:</p>

<div class="language-gd highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">signal</span> <span class="n">text_changed</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<p>Code can interact with signals via the <code class="language-plaintext highlighter-rouge">connect</code> (listen), <code class="language-plaintext highlighter-rouge">disconnect</code> (stop listening) and <code class="language-plaintext highlighter-rouge">emit_signal</code> (notify/raise) methods. Signals are also accessible from the Godot editor where new connections can be created.</p>

<p>The equivalent of a signal declaration in C# is a delegate declaration with a <code class="language-plaintext highlighter-rouge">Signal</code> attribute. They can be interacted with them using the aforementioned methods. While this did the job well and it’s pretty much the same as GDScript, I was never fully satisfied with it.</p>

<p>In .NET, the common way to implement the observer pattern is using <a href="https://docs.microsoft.com/en-us/dotnet/standard/events/">events</a>. Compared to events, C# code that uses Godot signals looks foreign.</p>

<p>Last month, motivated by the new <a href="https://godotengine.org/article/core-refactoring-progress-report-1">Callable</a> type, I decided to re-think the implementation of signals in C#. The goal this time is to expose them as events. It’s not finished, but the initial results are looking great.</p>

<p><img src="/storage/app/media/mono/csharp_signals_as_events.png" alt="Code completion for signals events" />
<em>Code-completion of signals events for the <code class="language-plaintext highlighter-rouge">Godot.CheckBox</code> class</em></p>

<p>In the following code example we can see how it compares to the old style:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Old style</span>
<span class="k">class</span> <span class="nc">TextField</span> <span class="p">:</span> <span class="n">Node</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">Signal</span><span class="p">]</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">TextChanged</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">);</span>

    <span class="k">void</span> <span class="nf">Foo</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">Connect</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">TextChanged</span><span class="p">),</span> <span class="k">this</span><span class="p">,</span> <span class="k">nameof</span><span class="p">(</span><span class="n">TextChangedCallback</span><span class="p">));</span>
        <span class="nf">EmitSignal</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">TextChanged</span><span class="p">),</span> <span class="s">"bar"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">TextChangedCallback</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// New style</span>
<span class="k">class</span> <span class="nc">TextField</span> <span class="p">:</span> <span class="n">Node</span> <span class="p">{</span>
    <span class="k">delegate</span> <span class="k">void</span> <span class="nf">TextChangedHandler</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">);</span>
    <span class="p">[</span><span class="n">Signal</span><span class="p">]</span> <span class="k">event</span> <span class="n">TextChangedHandler</span> <span class="n">TextChanged</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Foo</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">TextChanged</span> <span class="p">+=</span> <span class="n">TextChangedCallback</span><span class="p">;</span>
        <span class="c1">// TextChanged?.Invoke("bar"); // Nope, not yet :(</span>
        <span class="nf">EmitSignal</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">TextChanged</span><span class="p">),</span> <span class="s">"bar"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">TextChangedCallback</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As seen in the example, the most important part that’s missing is support for raising the event. This right now would only invoke the event delegates, but it won’t emit the signal, which is important to notify engine and GDScript listeners. As such, we still need to use the classic <code class="language-plaintext highlighter-rouge">EmitSignal</code> call, which will emit the signal as well as raise the event. More work will be needed in order to support event raising.</p>

<h1 id="what-comes-next">What comes next</h1>

<p>This progress report came really delayed. You can expect a new one in the next weeks, in which I’ll be announcing Godot extensions for both Visual Studio and VS Code!</p>

<p>After that there are two more tasks in my current roadmap. One of them is separating the Godot API into namespaces (right now we have everything in the same bloated namespace).</p>

<p>The other task is writing a C# API to wrap the Godot file system. This new API is meant to replace the auto-generated <code class="language-plaintext highlighter-rouge">Directory</code> and <code class="language-plaintext highlighter-rouge">File</code> classes (which will still be available for compatibility). The new API is meant to be very similar to what developers are used to in .NET.</p>

<p>C# is now working on almost every platform Godot supports, with the exception of the Universal Windows Platform (UWP). While UWP is not part of my current roadmap, support for it is likely to happen before 4.0 is released. Also WebAssembly, while already working, is still lacking AOT compilation from Godot which is of high priority.</p>

			</div>
		</div>
	</article>
</div>

<link rel="stylesheet" href="/assets/css/anchor-link.css?1">
<link rel="stylesheet" href="/assets/css/article-cards.css?1">
<script src="/assets/js/anchor-link.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Add icons to easily copy section links.
		window.applyAnchorLinks('.article-body');

		// Add lightbox elements in blog articles for Tobii.
		document.querySelectorAll('.article-cover img, .article-body img').forEach((articleImg) => {
			if (articleImg.classList.contains('lightbox-ignore')) {
				return;
			}

			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});
	});
</script>

</main>

<footer>
	<div class="container flex footer-container">
		<div id="copyright">
			<p>
				© 2007-2023 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a>.<br>
				Hosted by the <a href="https://godot.foundation/" target="_blank" rel="noopener">Godot Foundation</a>.<br>
				Website <a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">source code on  GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Communities and Events</a></li>
				<li><a href="/press">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features">Features</a></li>
				<li><a href="/showcase">Showcase</a></li>
				<li><a href="/education">Education</a></li>
				<li><a href="/license">License</a></li>
				<li><a href="/code-of-conduct">Code of Conduct</a></li>
				<li><a href="/privacy-policy">Privacy Policy</a></li>
				<li><a href="https://fund.godotengine.org">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance">Governance</a></li>
				<li><a href="/teams">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact">Contact us</a></h4>
			<div class="flex justify-space-between" style="gap: 3px;">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://mastodon.gamedev.place/@godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/mastodon_logo.svg" width="32" height="32" alt="Mastodon">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});

		// Update any download link to point to identified user's OS.
		const links = document.querySelectorAll('.set-os-download-url');
		for (let i = 0; i < links.length; i++) {
			const link = links[i];
			let link_slug = 'download';
			if ('version' in link.dataset && link.dataset['version'] === '3') {
				link_slug = 'download/3.x';
			}

			let link_platform = 'windows';
			if (navigator.platform.indexOf('Mac') !== -1) {
				link_platform = 'macos';
			} else if (navigator.platform.indexOf('Linux') !== -1) {
				link_platform = 'linux';
			}

			link.href = `/${link_slug}/${link_platform}`;
		}
	});
</script>


</body>

</html>
