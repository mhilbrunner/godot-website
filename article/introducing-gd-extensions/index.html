<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="Godot is getting a new plugin interface called GDExtension, an evolution of GDNative.">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org/article/introducing-gd-extensions/">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="Introducing GDNative's successor, GDExtension">
	<meta property="og:description" content="Godot is getting a new plugin interface called GDExtension, an evolution of GDNative.">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/615/1af/2c5/6151af2c5f132737201406.png">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>Introducing GDNative's successor, GDExtension</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css?111">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/icons/hamburger.svg" width="24" height="24" alt="Main menu">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/features">Features</a></li>
				<li class="only-on-mobile"><a href="/showcase">Showcase</a></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Community</a></li>
				<li><a href="/contact">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Learn</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="https://fund.godotengine.org">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.article-info {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.article-metadata {
		display: flex;
		gap: 24px;
		align-items: center;
		font-family: var(--header-font-family);
		margin-bottom: 12px;
	}

	@media (max-width: 900px) {
		.article-metadata {
			flex-direction: column;
			align-items: flex-start;
			gap: 16px;
		}
	}

	.article-author {
		color: var(--base-color-text-subtitle-date);
		font-weight: 700;
		font-size: 18px;
		flex-grow: 1;
		display: flex;
		gap: 12px;
		align-items: center;
	}

	.article-author .avatar {
		border-radius: 100%;
		margin: 0;
	}

	.article-author .by {
		color: var(--base-color-text-subtitle);
	}

	.article-metadata .date {
		color: var(--base-color-text-subtitle-date);
	}

	.article-metadata .date.post-recent-highlight {
		color: var(--post-recent-highlight-color);
		opacity: 0.8;
	}

	.article-metadata .date.post-recent-highlight::after {
		font-size: 80%;
		content: "NEW";
		border: 2px solid var(--post-recent-highlight-color);
		padding: 2px 3px;
		margin-left: 8px;
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="padded">
		<div class="content article-container">
			<figure class="article-cover">
				

				<img src="/storage/app/uploads/public/615/1af/2c5/6151af2c5f132737201406.png" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto; background-color: transparent;" />
			</figure>

			<div class="article-info">
				<h1>
					Introducing GDNative's successor, GDExtension
				</h1>
				<div class="article-metadata">
					<div class="article-author">
						<span>By: </span>
						
						
							<img class="avatar" width="25" height="25" src="/assets/images/authors/bastiaan.jpg" alt="Bastiaan Olij" loading="lazy">
						
						<span class="by">Bastiaan Olij</span>
					</div>
					<span class="date" data-post-date="2021-09-27 00:00:00 +0000"> 27 September 2021</span>
				</div>

				<div class="tags">
					
					<a href="/blog/progress-report">
						<div class="tag active">Progress Report</div>
					</a>
					
				</div>
			</div>

			



	<div class="card card-warning">
		<p>
		
			This article is from <strong>September 2021</strong>, some of its contents might be outdated and no longer accurate.<br>
			You can find up-to-date information about the engine in the <a href="https://docs.godotengine.org/en/stable/">official documentation</a>.
		
		</p>
	</div>





			<div class="article-body">
				<p>In the past month, the team has been hard at work introducing the new native extensions system for Godot 4.0. GDExtension is a new implementation of the GDNative layer that allows the creation of compiled plugins for the engine. At its core, GDExtension is a C API that enables registration of classes implemented within a dynamic library. This allows dynamic libraries to be used by Godot in a way that is much better integrated than its predecessor, GDNative. Together with the godot-cpp library, GDExtension introduces a system that allows extending Godot to nearly the same level as statically linked C++ modules can.</p>

<p>The new registration system is now part of Godot’s ClassDB. This means that classes implemented in plugins are indistinguishable from core classes.</p>

<p>When you add a node to your scene, they are selectable as any other class:
<img src="/storage/app/media/devlog/extensions/Select%20Example.png" alt="" /></p>

<p>Help pages are automatically made available for your classes, detailing their properties, methods, signals, etc.:
<img src="/storage/app/media/devlog/extensions/Help%20example.png" alt="" />
We’re still working on the ability to also add descriptions to each.</p>

<blockquote>
  <p><strong>This is a breaking change to the system.</strong> GDNative plugins written for Godot 3 will not run on Godot 4 and vice versa. Plugins written for Godot 3 will need to be altered and compiled for Godot 4.</p>
</blockquote>

<h3 id="branches">Branches</h3>

<p>The logic for extensions within Godot itself has been fully merged into the <code class="language-plaintext highlighter-rouge">master</code> branch.</p>

<p>The <code class="language-plaintext highlighter-rouge">master</code> branch in the <a href="https://github.com/godotengine/godot-headers">godot-headers repository</a> has been updated to contain the headers for GDExtension. An <code class="language-plaintext highlighter-rouge">extension_api.json</code> file that contains definition information about all the core classes accessible from extensions was also added.
The <code class="language-plaintext highlighter-rouge">3.x</code> branch in the godot-headers repository can be used for plugin development using the old GDNative API for Godot 3.</p>

<p>The <code class="language-plaintext highlighter-rouge">master</code> branch in the <a href="https://github.com/godotengine/godot-cpp">godot-cpp repository</a> has also been updated with the new godot-cpp implementation for GDExtension. It can now only be used to develop plugins for Godot 4. As with godot-headers, use the <code class="language-plaintext highlighter-rouge">3.x</code> branch when developing plugins for Godot 3.</p>

<h3 id="building-the-test-plugin">Building the test plugin</h3>

<p>We’ll be adding a full tutorial to the documentation in the future. For now, we’ll highlight the test project that is embedded in the godot-cpp repository.</p>

<p>The first step is always to compile the godot-cpp library. The build tools are the same as for Godot itself, so we will be using SCons for this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd godot-cpp
scons target=debug
</code></pre></div></div>

<p>By default, the target platform will be configured to match your host OS. Add <code class="language-plaintext highlighter-rouge">platform=&lt;name&gt;</code> to force building for a specific platform. You <strong>must</strong> compile with <code class="language-plaintext highlighter-rouge">target=debug</code> for your plugin to work in the editor. If run SCons for the first time, the C++ bindings code will be generated from the <code class="language-plaintext highlighter-rouge">extension_api.json</code> file automatically. However, if you update this JSON file afterwards, you’ll need to add <code class="language-plaintext highlighter-rouge">generate_bindings=yes</code> to the SCons command line.</p>

<p>Now you can compile the test project:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd godot-cpp/test
scons target=debug
</code></pre></div></div>

<p>Once built successfully, you can open the project in <strong>godot-cpp/test/demo</strong> in the Godot editor and try it out.</p>

<p><em><strong>Note:</strong> It’s not ideal to have the test project inside the godot-cpp folder. You would normally have godot-cpp stored in a subfolder of your project – preferably as a submodule if you use Git as a version control system. We’ll address that in the tutorial.</em></p>

<h3 id="taking-a-closer-look-at-the-test-project">Taking a closer look at the test project</h3>

<p>Now that the test project is working we can have a closer look at its core components.</p>

<p>In the demo folder, we can see a file called <strong>example.gdextension</strong>. This replaces the old <code class="language-plaintext highlighter-rouge">.gdnlib</code> files and tells Godot how to load your plugin:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[configuration]

entry_symbol = "example_library_init"

[libraries]

linux.64 = "bin/x11/libgdexample.so"
windows.64 = "bin/win64/libgdexample.dll"
</code></pre></div></div>

<p>Under <code class="language-plaintext highlighter-rouge">configuration</code>, we define the name of the function in our plugin that will initialise our plugin.</p>

<p>Under <code class="language-plaintext highlighter-rouge">libraries</code>, we specify the name of the dynamic library for each platform.</p>

<p><em><strong>Note:</strong> Unlike GDNative, there are no <code class="language-plaintext highlighter-rouge">.gdns</code> files for each class anymore.</em></p>

<p>The next file to look at is <code class="language-plaintext highlighter-rouge">register_types.cpp</code> inside the <code class="language-plaintext highlighter-rouge">src/</code> folder. In that file, we find our library entry point that was defined in our <code class="language-plaintext highlighter-rouge">example.gdextension</code> file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GDNativeBool GDN_EXPORT example_library_init(const GDNativeInterface *p_interface, const GDNativeExtensionClassLibraryPtr p_library, GDNativeInitialization *r_initialization) {
	godot::GDExtensionBinding::InitObject init_obj(p_interface, p_library, r_initialization);

	init_obj.register_scene_initializer(register_example_types);
	init_obj.register_scene_terminator(unregister_example_types);

	return init_obj.init();
}
</code></pre></div></div>

<p>This code creates an initializer object and registers a number of callbacks. These callbacks allow us to register and construct objects at different points of Godot’s initialisation. For our example library, we use <code class="language-plaintext highlighter-rouge">register_scene_initializer()</code> to register our classes.</p>

<p>When we look at this callback, we see that we register our class:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void register_example_types() {
	ClassDB::register_class&lt;Example&gt;();
}
</code></pre></div></div>

<p>Next, let’s look at a stripped out version of our example class. First, its header file <code class="language-plaintext highlighter-rouge">example.h</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Example : public Control {
	GDCLASS(Example, Control);

protected:
	static void _bind_methods();

private:
	Vector2 custom_position;

public:
	void set_custom_position(const Vector2 &amp;pos);
	Vector2 get_custom_position() const;
};
</code></pre></div></div>

<p>Our Example class inherits Godot’s own Control node class. Besides the normal C++ syntax, we need to add the <code class="language-plaintext highlighter-rouge">GDCLASS()</code> macro so it gets properly registered with Godot.</p>

<p>Next, we see the definition of <code class="language-plaintext highlighter-rouge">_bind_methods()</code>. This is the function that will register our methods, properties, etc. with Godot.</p>

<p>We also introduce a private variable called <code class="language-plaintext highlighter-rouge">custom_position</code>, plus a setter and getter method for this variable.</p>

<p>In the implementation (<code class="language-plaintext highlighter-rouge">example.cpp</code>), we put it all together. First, our method binding logic:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void Example::_bind_methods() {
	ClassDB::bind_method(D_METHOD("get_custom_position"), &amp;Example::get_custom_position);
	ClassDB::bind_method(D_METHOD("set_custom_position", "position"), &amp;Example::set_custom_position);
	ADD_PROPERTY(PropertyInfo(Variant::VECTOR2, "custom_position"), "set_custom_position", "get_custom_position");
}

</code></pre></div></div>
<p>The first two lines of code register our getter and setter function with Godot. Note that we also name the setter method’s parameter.
This is how you register any method of your class.
The third line however turns this into a property called <code class="language-plaintext highlighter-rouge">custom_position</code>.</p>

<p>The getter and setter method logic is just plain C++ code – nothing special to highlight there:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void Example::set_custom_position(const Vector2 &amp;pos) {
	custom_position = pos;
}

Vector2 Example::get_custom_position() const {
	return custom_position;
}

</code></pre></div></div>

<p>The example has many more things implemented such as constants, signals, methods with a variable number of parameters, etc. It’s a good place to look at how to use those things in your own plugin.</p>

<p>To those who’ve written Godot modules before, this code should look familiar as much of the syntax is identical.</p>

<h3 id="where-to-go-from-here">Where to go from here</h3>

<p>We’ll have some proper tutorials up soon. Until then, come <a href="https://godotengine.org/community">talk to us on <code class="language-plaintext highlighter-rouge">#gdextension</code> on the Godot Contributors Chat or in <code class="language-plaintext highlighter-rouge">#gdnative</code> on the Godot Discord</a>. A number of us are working on our own plugins and are sharing source code. One such example is the <a href="https://github.com/GodotVR/godot_xr_reference">Godot XR reference plugin</a>, which contains a far more elaborate example.</p>

			</div>
		</div>
	</article>
</div>

<link rel="stylesheet" href="/assets/css/anchor-link.css?1">
<link rel="stylesheet" href="/assets/css/article-cards.css?2">
<script src="/assets/js/anchor-link.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Add icons to easily copy section links.
		window.applyAnchorLinks('.article-body');

		// Add lightbox elements in blog articles for Tobii.
		document.querySelectorAll('.article-cover img, .article-body img').forEach((articleImg) => {
			if (articleImg.classList.contains('lightbox-ignore')) {
				return;
			}

			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});
	});
</script>

</main>

<footer>
	<div class="container flex footer-container">
		<div id="copyright">
			<p>
				© 2007-2024 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a>.<br>
				Hosted by the <a href="https://godot.foundation/" target="_blank" rel="noopener">Godot Foundation</a>.<br>
				Website <a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">source code on  GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Communities and Events</a></li>
				<li><a href="/press">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features">Features</a></li>
				<li><a href="/showcase">Showcase</a></li>
				<li><a href="/education">Education</a></li>
				<li><a href="/license">License</a></li>
				<li><a href="/code-of-conduct">Code of Conduct</a></li>
				<li><a href="/privacy-policy">Privacy Policy</a></li>
				<li><a href="https://fund.godotengine.org">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance">Governance</a></li>
				<li><a href="/teams">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact">Contact us</a></h4>
			<div class="flex justify-space-between" style="gap: 3px;">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://mastodon.gamedev.place/@godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/mastodon_logo.svg" width="32" height="32" alt="Mastodon">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		document.querySelectorAll('[data-post-date]').forEach((postDate) => {
			// Highlight post dates that are less than 48 hours old.
			if (Date.parse(postDate.dataset.postDate) > (Date.now() - 1000 * 60 * 60 * 48)) {
				postDate.classList.add("post-recent-highlight");
			};
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});

		// Update any download link to point to identified user's OS.
		const links = document.querySelectorAll('.set-os-download-url');
		for (let i = 0; i < links.length; i++) {
			const link = links[i];
			let link_slug = 'download';
			if ('version' in link.dataset && link.dataset['version'] === '3') {
				link_slug = 'download/3.x';
			}

			let link_platform = 'windows';
			if (navigator.platform.indexOf('Mac') !== -1) {
				link_platform = 'macos';
			} else if (navigator.platform.indexOf('Linux') !== -1) {
				link_platform = 'linux';
			}

			link.href = `/${link_slug}/${link_platform}`;
		}
	});
</script>


</body>

</html>
