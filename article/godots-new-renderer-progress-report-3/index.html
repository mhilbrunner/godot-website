<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="It's been a month since the second progress report, and progress continues towards the new Godot renderer. This milestone was (and will likely be) the most difficult, due to the techniques that had to be implemented.">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org/article/godots-new-renderer-progress-report-3/">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="Godot's new renderer, progress report #3">
	<meta property="og:description" content="It's been a month since the second progress report, and progress continues towards the new Godot renderer. This milestone was (and will likely be) the most difficult, due to the techniques that had to be implemented.">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/586/7a0/005/5867a0005ade3286241109.jpg">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>Godot's new renderer, progress report #3</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css?109">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/icons/hamburger.svg" width="24" height="24" alt="Main menu">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/features">Features</a></li>
				<div class="only-on-mobile" style="width: 100%">
					<li><a href="/showcase">Showcase</a></li>
				</div>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Community</a></li>
				<li><a href="/contact">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Learn</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="https://fund.godotengine.org">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.article-info {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.article-metadata {
		display: flex;
		gap: 24px;
		align-items: center;
		font-family: var(--header-font-family);
		margin-bottom: 12px;
	}

	@media (max-width: 900px) {
		.article-metadata {
			flex-direction: column;
			align-items: flex-start;
			gap: 16px;
		}
	}

	.article-author {
		color: var(--base-color-text-subtitle-date);
		font-weight: 700;
		font-size: 18px;
		flex-grow: 1;
		display: flex;
		gap: 12px;
		align-items: center;
	}

	.article-author .avatar {
		border-radius: 100%;
		margin: 0;
	}

	.article-author .by {
		color: var(--base-color-text-subtitle);
	}

	.article-metadata .date {
		color: var(--base-color-text-subtitle-date);
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="padded">
		<div class="content article-container">
			<figure class="article-cover">
				

				<img src="/storage/app/uploads/public/586/7a0/005/5867a0005ade3286241109.jpg" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto" />
			</figure>

			<div class="article-info">
				<h1>
					Godot's new renderer, progress report #3
				</h1>
				<div class="article-metadata">
					<div class="article-author">
						<span>By: </span>
						
						
							<img class="avatar" width="25" height="25" src="/assets/images/authors/reduzio.jpg" alt="Juan Linietsky" loading="lazy">
						
						<span class="by">Juan Linietsky</span>
					</div>
					<span class="date"> 31 December 2016</span>
				</div>

				<div class="tags">
					
					<a href="/blog/progress-report">
						<div class="tag active">Progress Report</div>
					</a>
					
				</div>
			</div>

			



	<div class="card card-warning">
		<p>
		
			This article is from <strong>December 2016</strong>, some of its contents might be outdated and no longer accurate.<br>
			You can find up-to-date information about the engine in the <a href="https://docs.godotengine.org/en/stable/">official documentation</a>.
		
		</p>
	</div>





			<div class="article-body">
				<h1 id="introduction">Introduction</h1>

<p>It’s been a month since the <a href="/article/godots-new-renderer-progress-report-2">second progress report</a>, and progress continues towards the new Godot renderer. This milestone was (and will likely be) the most difficult, due to the techniques that had to be implemented.</p>

<p>As a result, many of the goals for it were not met (will have to be moved to a new Milestone 4), but hopefully everything that remains is simpler.</p>

<p>Here’s the list of tasks for the current milestone and the next one:</p>

<h3 id="todo-for-milestone-3-december-2016">TODO for Milestone #3 (December 2016)</h3>

<ul>
  <li><del>Implement the new version of the Godot SVO-based Light Baker.</del></li>
  <li><del>Implement post process effects: DOF Blur, Bloom and Tone Mapping.</del></li>
</ul>

<h3 id="todo-for-milestone-4-january-2017">TODO for Milestone #4 (January 2017)</h3>

<ul>
  <li>Implement Particle Shaders, with support for: Sorting, Collision and Soft Particles.</li>
  <li>Improve Culling: Portals (rewrite as polygon-based) and Rooms.</li>
  <li>Add Clustered lighting (before this all is forward).</li>
  <li>Add Layered/Stencil rendering.</li>
  <li>Implement Decals.</li>
</ul>

<h1 id="detail-of-tasks-done-for-milestone-3-december-2016">Detail of tasks done for Milestone #3 (December 2016)</h1>

<h2 id="glow-processor">Glow Processor</h2>

<p>Glow effects are most commonly done by taking the whole screen, shrinking it, blurring it and then blending it back (using screen, additive or soflight blending modes).</p>

<p>Godot 2.0 already supported this in a more or less limited fashion, so the challenge for 3.0 was, how to make glow much better? how to make it totally awesome?</p>

<h4 id="multi-stage-glow">Multi-Stage glow</h4>

<p>Godot 3.0 implements glow in what is called a “multi-stage” configuration. The screen is blurred to successive mipmaps (i.e. <code class="language-plaintext highlighter-rouge">screen_size/2</code>, <code class="language-plaintext highlighter-rouge">screen_size/4</code>, <code class="language-plaintext highlighter-rouge">screen_size/8</code>, etc). From there on, it’s up to the user to decide which ones to enable:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr3.png" alt="" /></p>

<p>The lower mipmaps give objects an aura (similar to Godot 2.0), while the higher ones produce a beautiful bloom effect:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr1.jpg" alt="" /></p>

<h4 id="better-upscaling">Better Upscaling</h4>

<p>Of course, an usual problem with doing glow this way is that you can see arctifacts related to linear interpolation (the glow is “blocky”). To avoid this, an optional bicubic upscaler is provided:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr2.jpg" alt="" /></p>

<h2 id="tone-mapping">Tone Mapping</h2>

<p>As was mentioned in previous posts, Godot 3.0 renderer works entirely in linear space (Gamma is no longer supported). This workflow allows for something nice called “tone mapping”, which means that the output image in linear space can be applied a curve to make some details more visible.</p>

<p>Godot 2.0 supported only Linear and Reinhard tonemappers. Godot 3.0 supports Linear, Reinhard, Filmic and Aces tonemappers.</p>

<h2 id="auto-exposure-scale">Auto Exposure Scale</h2>

<p>Godot 3.0 supports the same auto-exposure scale method as Godot 2.0, which worked pretty well. The advantage is that it can be combined much better with the new Bloom, allowing fantastic looking effects:</p>

<p><img src="/storage/app/media/devlog/progress3/blur80.gif" alt="" /></p>

<h2 id="depth-of-field">Depth of Field</h2>

<p>Godot 3.0 supports far and near depth of field blur, in different quality settings to have better performance/quality options.</p>

<p>For the FAR depth of field, Godot 3.0 implements the typical weighted blur based on distance, this works nicely:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr4.jpg" alt="" /></p>

<p>NEAR DOF is considerably more difficult to implement, and correct implementations are usually demanding in GPU (two separable convolution buffers must exist in parallel).</p>

<p>As the aim of Godot is to run nicely on low end hardware, a novel algorithm was implemented, which allows high quality bluring of near objects in a single separable pass:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr5.jpg" alt="" /></p>

<p>The result is a little less correct, but the performance benefits are large.</p>

<p>Both DOF effects can be used together for specifying focal regions:</p>

<p><img src="/storage/app/media/devlog/progress3/dof_blur4.gif" alt="" /></p>

<h2 id="gi-probes">GI Probes</h2>

<p>The new GI probe implementation in Godot is a game changer, and gives Godot 3.0 an edge in quality over existing mainstream engines.</p>

<p>GIProbe is a new node that is placed in the scene in a similar way as you place a reflection probe. It must be pre-baked for dynamic scenario geometry, but it offers support for full dynamic lights and dynamic objects.</p>

<p>It works by implementing <a href="http://on-demand.gputechconf.com/gtc/2012/presentations/SB134-Voxel-Cone-Tracing-Octree-Real-Time-Illumination.pdf">voxel cone tracing</a> in a way that is friendlier with low end GPUs and high end mobile.</p>

<p>The light voxel is computed on CPU, allowing all types of dynamic lights, then uploaded to a 3D texture (with optional real-time compression, to improve memory usage and performance) used by the shader:</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr6.jpg" alt="" /></p>

<p>Here’s how an area that receives no light at all gets lit by indirect bounces!</p>

<p><img src="/storage/app/media/devlog/progress3/nrpr7.jpg" alt="" /></p>

<p>Support for materials with emission also exists, allowing full scene lighting using emissive materials:</p>

<p><img src="/storage/app/media/devlog/progress3/gdmonkeys.jpg" alt="" />
<img src="/storage/app/media/devlog/progress3/nrpr8.jpg" alt="" />
<img src="/storage/app/media/devlog/progress3/nrpr9.jpg" alt="" /></p>

<p>A great advantage of this technique compared to other implementations (such as Enlighten or any other lightmap-based baking), is that full reflections are possible, with much higher quality than using reflection probes:</p>

<p><img src="/storage/app/media/devlog/progress3/realtime_gi.gif" alt="" />
<img src="/storage/app/media/devlog/progress3/vctr2.gif" alt="" /></p>

<p>Finally, dynamic objects get full light and reflections from the GIProbe when they move around inside, without having to use any kind of probe groups:</p>

<p><img src="/storage/app/media/devlog/progress3/light_information.gif" alt="" /></p>

<h2 id="future">Future</h2>

<p>The last remaining big feature is the new particle system, then everything else is simpler, and includes cleaning up the implemented techniques. Hoping that by the end of January, the new renderer will be mostly done!</p>

<h2 id="seeing-the-code">Seeing the code</h2>

<p>If you are interested in seeing what each feature looks like in the code, you can check the <a href="https://github.com/godotengine/godot/commits/gles3">gles3 branch</a> on GitHub.</p>

			</div>
		</div>
	</article>
</div>

<link rel="stylesheet" href="/assets/css/anchor-link.css?1">
<link rel="stylesheet" href="/assets/css/article-cards.css?1">
<script src="/assets/js/anchor-link.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Add icons to easily copy section links.
		window.applyAnchorLinks('.article-body');

		// Add lightbox elements in blog articles for Tobii.
		document.querySelectorAll('.article-cover img, .article-body img').forEach((articleImg) => {
			if (articleImg.classList.contains('lightbox-ignore')) {
				return;
			}

			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});
	});
</script>

</main>

<footer>
	<div class="container flex footer-container">
		<div id="copyright">
			<p>
				© 2007-2023 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a>.<br>
				Hosted by the <a href="https://godot.foundation/" target="_blank" rel="noopener">Godot Foundation</a>.<br>
				Website <a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">source code on  GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Communities and Events</a></li>
				<li><a href="/press">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features">Features</a></li>
				<li><a href="/showcase">Showcase</a></li>
				<li><a href="/education">Education</a></li>
				<li><a href="/license">License</a></li>
				<li><a href="/code-of-conduct">Code of Conduct</a></li>
				<li><a href="/privacy-policy">Privacy Policy</a></li>
				<li><a href="https://fund.godotengine.org">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance">Governance</a></li>
				<li><a href="/teams">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact">Contact us</a></h4>
			<div class="flex justify-space-between" style="gap: 3px;">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://mastodon.gamedev.place/@godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/mastodon_logo.svg" width="32" height="32" alt="Mastodon">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});

		// Update any download link to point to identified user's OS.
		const links = document.querySelectorAll('.set-os-download-url');
		for (let i = 0; i < links.length; i++) {
			const link = links[i];
			let link_slug = 'download';
			if ('version' in link.dataset && link.dataset['version'] === '3') {
				link_slug = 'download/3.x';
			}

			let link_platform = 'windows';
			if (navigator.platform.indexOf('Mac') !== -1) {
				link_platform = 'macos';
			} else if (navigator.platform.indexOf('Linux') !== -1) {
				link_platform = 'linux';
			}

			link.href = `/${link_slug}/${link_platform}`;
		}
	});
</script>


</body>

</html>
